---
title: "新人プログラマがLISPを学んだらプログラミングの見方が変わった"
date: "2018-12-05T18:17:51.000Z"
updatedAt: ""
template: "post"
draft: false
slug: "/posts/learning-lisp-enlighten-me-what-is-the-programing"
category: "Essay"
tags:
    - "LISP"
description: ""
socialImage: ""
---

2018年LISPアドベントカレンダー5日目の投稿です。

## LISPの悟り
新人プログラマが学ぶべきプログラミング言語を説く解説記事は星の数ほどあります。
そのどれかに記述があったのでしょうか、いつしか「LISPという難解な言語を触ると悟りが得られる」と知りました。

では、プログラミングの見方が変わる「LISPの悟り」＝「LISPを学ぶことの効用」とは一体なんでしょうか。気になって下記の記事を読んでみました。すると、気になる一文に目がとまりました。

> この悟りは、コンピュータを利用する上で「データは人間の為だけのものじゃない」ことを実感するような経験によることでしょう。
[「Lispの悟りが分かっちゃう新春ポエム」](https://qiita.com/g000001/items/a31c150df1e3213b7329)

この内容、初読では理解できませんでした。平易な日本語なのに理解ができないのはどこか居心地が悪いものです。そして自分も悟ってみたいという好奇心が自分を後押しして、LISPを実際に触ってみることにしました。

以下では、プログラマ１年生の自分が、「Land of Lisp」を読んで得たLISPへの理解、引いてはプログラミングに対する見方が変わった点を紹介したいと思います。

## LISPのコードとデータ
LISPにはコードモードとデータモードがあります。
コードは関数を実行するもの（コマンド・命令）。データは文字通り情報です。

累乗を計算するexpt関数で例を見てみましょう。

```lisp
;; コードモード
(expt 2 3) ;; 2^3 = 8

;; データモード
'(expt 2 3) ;; (expt 2 3)
```

コードモードでは、リストの先頭の要素`expt`がコマンドで、リストの残りの要素はこの関数の引数です。全体を通して、「2を3乗する」という処理になっています。

一方、データモードではリストの先頭に`'（シングルクオート）`をつけます。このように記述すると、LISPではシングルクオート以降のリストはデータとして扱われるため、コードが実行されることはありません。

## プログラミングに対する理解

プログラミングはデータのインプットとアウトプットをするアプリケーションを作成することです。アプリケーションの内部ではデータの作成・読み取り・更新（加工）・削除といった処理を行なっています。プログラミングパラダイムが手続き型であれ、オブジェクト指向型であれ、関数型であれ、この点は同じだと思います。

このように考えると、プログラミングは、このコマンド（＝データ処理）の組み合わせだと思います。
異論はあると思いますが、一旦このことを念頭に入れて下さい（マサカリを投げないで😢）。

## オブジェクト指向の世界
一方、オブジェクト指向では、クラスというものは一般的に下記のように説明されます。

> 「クラスは、データと振る舞いをカプセル化したものである」
[参考：プロパティ？フィールド？メンバー？C#のクラス構造のおさらい](https://qiita.com/toshi0607/items/801a0d37fb48313cbdbd)

オブジェクトはメソッドとプロパティで構成されています。LISPの考え方を援用すると、メソッドはコマンド（振る舞い）、プロパティはデータと言い換えられるのではないか。そう思い至った時、オブジェクト指向の見方が変わりました。

オブジェクトのメソッドは、データを処理するだけであると考えると、メソッド内でローカル変数を定義することをできる限り避けるようになりました。そのオブジェクトで持つにふさわしいデータはプロパティに持たせるべきです。

メソッドの引数にデータを入れると、返り値としてデータが返ってくる。メソッドの中身はコマンドです。オブジェクト指向だと、プロパティをメソッド内で参照することがありますが、この時「メソッドは引数以外のデータ、しかもそのクラス内で存在しているデータを参照しているのだ」と意識するようになりました。

データはオブジェクトのプロパティに、あるいは定数としてオブジェクトの外に持たせるべきである、と思うに至りました。

通り一遍にオブジェクト指向を学べば、入門書にも書いてある内容でしょう。しかし、LISPを学ぶことでこの内容が腹落ちしました。

また、データであれば形式は問いません。プロパティである必要もありません。JSONもデータの塊、CSV,TSVもデータの塊です。どこから読み取ってもデータはデータ。このデータの中には、データ自身を操作するプログラムが入り込む余地はありません。

ここまでオブジェクト指向の記述です。
（もちろんオブジェクト指向はこれだけではありません。オブジェクト指向はオブジェクト同士のメッセージの伝達により、処理を行うプログラミングの方法です。ここでは特にプロパティとメソッドについて記述をしました）

## LISPの世界

一方、LISPにはオブジェクトもプロパティはありません([CLOS](https://ja.wikipedia.org/wiki/Common_Lisp_Object_System)の議論は省きます)。
LISPの関数は第一級（first-class function）です。第一級の関数は、文字列や数値と同じように関数の引数として使用したり、配列に格納することができます。

つまり、LISPの関数（コマンド）はデータとして扱うことができます。
ここまでくると、最初に紹介した記事の締めくくりの一文も、理解できるのではないでしょうか。

> Lispは色々なパラダイムと組み合わせられますが、何がLispかといえば、
> プログラム ＝ データ であることに尽きるのではないでしょうか。

## データ型に対する理解
### 算術演算子と論理演算子
データは人間のためだけのものではありません。コンピュータがデータを処理するにあたって、データに型（type）を与え、コンピュータで扱えるものにする必要があります。

例えば、人間には同じように見えるけれども、文字列型と数値型で計算の結果が異なることは周知の事実です。
（以下はJavaScriptのコードです）

```javascript
 var result1 = 1 + 1; // int型
 var result2 = "1" + "1"; // string型

 console.log(result1); // 2
 console.log(result2); // 11
```

float型とint型もややこしいですね。人間から見れば`1`も`1.0`も同じ`1`。でもコンピュータから見れば別物なのです。

では、論理型の計算はどうでしょうか。論理型には論理和、論理積という計算方法があります。この計算のために、多くの言語では論理演算子に`||`, `&&`, `!`が定義されています。  

```javascript
var now = new Date;
var isWeekDay = [1,2,3,4,5].indexOf(now.getDay()) >= 0;

if (now.getHours() === 7 && isWeekDay) {
    // 朝起きる
} 
```

このプログラムを実行するタイミングが月曜日の朝7時である時、`if (true && true){}`に見えますか？これがboolean型の計算であるように見えますか？
パッとみてそのように見える方は熟練プログラマでしょう。次の章は飛ばしてOKです。

### LISPの演算
LISPはシンプルな言語です。以下は足し算をする処理です。

```lisp
(+ 1 1)
```
ご想像の通り、結果は`2`です。
次は値を比較してみましょう。

```lisp
(eq (+ 1 1) 2)
```
このコードは`(eq 2 2)`として評価されます。結果は`T`（true）です。
次は論理演算子を使ったコードをみてみましょう。

```lisp
(and (eq 1 1)
     (eq 2 2))
```
このコードは`(and T T)`として評価されるため、結果は`T`（true）です。

`&&`と`and`は同じ役割をしています。が、LISPの方がより一層「演算」という役割が明確にされています。**コンピュータでは数値も文字列も真理値も演算することができます。**条件式で`&&`や`||`、`!`を打ち込むときに、「今自分は論理の計算をしているのだ」と意識することになるでしょう。
（論理演算について詳しく知りたい方はこちら：[あなたは論理演算がわかりますか？](https://tech.nikkeibp.co.jp/it/members/ITPro/ITBASIC/20020731/1/)）

## 次なる悟りへ
ここまで読んだあなたは、本稿を読む前に比べてプログラミングに対する、またコンピュータに対する見方が変化したのではないでしょうか。
他にも再帰関数やマクロ、コンスセル（リスト）というデータの格納方法など、LISPにはプログラミングの見方を変えてくれる要素がたくさんあります。

この文章を通して、データとは何か、functionとは何か、演算とは何か、今まで見てきたものが、全く違う見方になれば幸いです。

あなた自身のさらなる悟りを得るために、ぜひLISPに入門してみてください。
